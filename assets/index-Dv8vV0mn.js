import{r as a,R as B,b as Le,j as N}from"./index-BgaK83vk.js";import{m as Te}from"./monaco-editor-core-BnvmR1fi.js";import{j as $}from"./PageHeader-lipHC_FJ.js";import"./ton-vendor-E5L4Lu3I.js";function _e(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function de(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function pe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?de(Object(r),!0).forEach(function(n){_e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):de(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ae(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function Pe(e,t){if(e==null)return{};var r=Ae(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Ie(e,t){return Ne(e)||$e(e,t)||De(e,t)||xe()}function Ne(e){if(Array.isArray(e))return e}function $e(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var r=[],n=!0,o=!1,i=void 0;try{for(var s=e[Symbol.iterator](),c;!(n=(c=s.next()).done)&&(r.push(c.value),!(t&&r.length===t));n=!0);}catch(f){o=!0,i=f}finally{try{!n&&s.return!=null&&s.return()}finally{if(o)throw i}}return r}}function De(e,t){if(e){if(typeof e=="string")return ge(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ge(e,t)}}function ge(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function xe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Fe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function me(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function he(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?me(Object(r),!0).forEach(function(n){Fe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):me(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Re(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(n){return t.reduceRight(function(o,i){return i(o)},n)}}function U(e){return function t(){for(var r=this,n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return o.length>=e.length?e.apply(this,o):function(){for(var s=arguments.length,c=new Array(s),f=0;f<s;f++)c[f]=arguments[f];return t.apply(r,[].concat(o,c))}}}function Y(e){return{}.toString.call(e).includes("Object")}function Be(e){return!Object.keys(e).length}function q(e){return typeof e=="function"}function We(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function ze(e,t){return Y(t)||F("changeType"),Object.keys(t).some(function(r){return!We(e,r)})&&F("changeField"),t}function He(e){q(e)||F("selectorType")}function Ue(e){q(e)||Y(e)||F("handlerType"),Y(e)&&Object.values(e).some(function(t){return!q(t)})&&F("handlersType")}function Ke(e){e||F("initialIsRequired"),Y(e)||F("initialType"),Be(e)&&F("initialContent")}function qe(e,t){throw new Error(e[t]||e.default)}var Ze={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},F=U(qe)(Ze),G={changes:ze,selector:He,handler:Ue,initial:Ke};function Ve(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};G.initial(e),G.handler(t);var r={current:e},n=U(Je)(r,t),o=U(Xe)(r),i=U(G.changes)(e),s=U(Ge)(r);function c(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(p){return p};return G.selector(u),u(r.current)}function f(u){Re(n,o,i,s)(u)}return[c,f]}function Ge(e,t){return q(t)?t(e.current):t}function Xe(e,t){return e.current=he(he({},e.current),t),t}function Je(e,t,r){return q(t)?t(e.current):Object.keys(r).forEach(function(n){var o;return(o=t[n])===null||o===void 0?void 0:o.call(t,e.current[n])}),r}var Ye={create:Ve},Qe={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.52.2/min/vs"}};function et(e){return function t(){for(var r=this,n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return o.length>=e.length?e.apply(this,o):function(){for(var s=arguments.length,c=new Array(s),f=0;f<s;f++)c[f]=arguments[f];return t.apply(r,[].concat(o,c))}}}function tt(e){return{}.toString.call(e).includes("Object")}function rt(e){return e||ve("configIsRequired"),tt(e)||ve("configType"),e.urls?(nt(),{paths:{vs:e.urls.monacoBase}}):e}function nt(){console.warn(we.deprecation)}function ot(e,t){throw new Error(e[t]||e.default)}var we={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},ve=et(ot)(we),it={config:rt},st=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return function(o){return r.reduceRight(function(i,s){return s(i)},o)}};function ke(e,t){return Object.keys(t).forEach(function(r){t[r]instanceof Object&&e[r]&&Object.assign(t[r],ke(e[r],t[r]))}),pe(pe({},e),t)}var at={type:"cancelation",msg:"operation is manually canceled"};function ne(e){var t=!1,r=new Promise(function(n,o){e.then(function(i){return t?o(at):n(i)}),e.catch(o)});return r.cancel=function(){return t=!0},r}var ct=Ye.create({config:Qe,isInitialized:!1,resolve:null,reject:null,monaco:null}),Ce=Ie(ct,2),V=Ce[0],Q=Ce[1];function ut(e){var t=it.config(e),r=t.monaco,n=Pe(t,["monaco"]);Q(function(o){return{config:ke(o.config,n),monaco:r}})}function lt(){var e=V(function(t){var r=t.monaco,n=t.isInitialized,o=t.resolve;return{monaco:r,isInitialized:n,resolve:o}});if(!e.isInitialized){if(Q({isInitialized:!0}),e.monaco)return e.resolve(e.monaco),ne(oe);if(window.monaco&&window.monaco.editor)return Ee(window.monaco),e.resolve(window.monaco),ne(oe);st(ft,pt)(gt)}return ne(oe)}function ft(e){return document.body.appendChild(e)}function dt(e){var t=document.createElement("script");return e&&(t.src=e),t}function pt(e){var t=V(function(n){var o=n.config,i=n.reject;return{config:o,reject:i}}),r=dt("".concat(t.config.paths.vs,"/loader.js"));return r.onload=function(){return e()},r.onerror=t.reject,r}function gt(){var e=V(function(r){var n=r.config,o=r.resolve,i=r.reject;return{config:n,resolve:o,reject:i}}),t=window.require;t.config(e.config),t(["vs/editor/editor.main"],function(r){Ee(r),e.resolve(r)},function(r){e.reject(r)})}function Ee(e){V().monaco||Q({monaco:e})}function mt(){return V(function(e){var t=e.monaco;return t})}var oe=new Promise(function(e,t){return Q({resolve:e,reject:t})}),Z={config:ut,init:lt,__getMonacoInstance:mt},ht={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},ie=ht,vt={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},bt=vt;function yt({children:e}){return B.createElement("div",{style:bt.container},e)}var wt=yt,kt=wt;function Ct({width:e,height:t,isEditorReady:r,loading:n,_ref:o,className:i,wrapperProps:s}){return B.createElement("section",{style:{...ie.wrapper,width:e,height:t},...s},!r&&B.createElement(kt,null,n),B.createElement("div",{ref:o,style:{...ie.fullWidth,...!r&&ie.hide},className:i}))}var Et=Ct,je=a.memo(Et);function jt(e){a.useEffect(e,[])}var ce=jt;function Mt(e,t,r=!0){let n=a.useRef(!0);a.useEffect(n.current||!r?()=>{n.current=!1}:e,t)}var A=Mt;function K(){}function z(e,t,r,n){return Ot(e,n)||St(e,t,r,n)}function Ot(e,t){return e.editor.getModel(Me(e,t))}function St(e,t,r,n){return e.editor.createModel(t,r,n?Me(e,n):void 0)}function Me(e,t){return e.Uri.parse(t)}function Lt({original:e,modified:t,language:r,originalLanguage:n,modifiedLanguage:o,originalModelPath:i,modifiedModelPath:s,keepCurrentOriginalModel:c=!1,keepCurrentModifiedModel:f=!1,theme:u="light",loading:p="Loading...",options:g={},height:l="100%",width:d="100%",className:h,wrapperProps:w={},beforeMount:j=K,onMount:E=K}){let[M,y]=a.useState(!1),[T,O]=a.useState(!0),k=a.useRef(null),C=a.useRef(null),_=a.useRef(null),S=a.useRef(E),m=a.useRef(j),D=a.useRef(!1);ce(()=>{let v=Z.init();return v.then(b=>(C.current=b)&&O(!1)).catch(b=>b?.type!=="cancelation"&&console.error("Monaco initialization: error:",b)),()=>k.current?I():v.cancel()}),A(()=>{if(k.current&&C.current){let v=k.current.getOriginalEditor(),b=z(C.current,e||"",n||r||"text",i||"");b!==v.getModel()&&v.setModel(b)}},[i],M),A(()=>{if(k.current&&C.current){let v=k.current.getModifiedEditor(),b=z(C.current,t||"",o||r||"text",s||"");b!==v.getModel()&&v.setModel(b)}},[s],M),A(()=>{let v=k.current.getModifiedEditor();v.getOption(C.current.editor.EditorOption.readOnly)?v.setValue(t||""):t!==v.getValue()&&(v.executeEdits("",[{range:v.getModel().getFullModelRange(),text:t||"",forceMoveMarkers:!0}]),v.pushUndoStop())},[t],M),A(()=>{k.current?.getModel()?.original.setValue(e||"")},[e],M),A(()=>{let{original:v,modified:b}=k.current.getModel();C.current.editor.setModelLanguage(v,n||r||"text"),C.current.editor.setModelLanguage(b,o||r||"text")},[r,n,o],M),A(()=>{C.current?.editor.setTheme(u)},[u],M),A(()=>{k.current?.updateOptions(g)},[g],M);let P=a.useCallback(()=>{if(!C.current)return;m.current(C.current);let v=z(C.current,e||"",n||r||"text",i||""),b=z(C.current,t||"",o||r||"text",s||"");k.current?.setModel({original:v,modified:b})},[r,t,o,e,n,i,s]),R=a.useCallback(()=>{!D.current&&_.current&&(k.current=C.current.editor.createDiffEditor(_.current,{automaticLayout:!0,...g}),P(),C.current?.editor.setTheme(u),y(!0),D.current=!0)},[g,u,P]);a.useEffect(()=>{M&&S.current(k.current,C.current)},[M]),a.useEffect(()=>{!T&&!M&&R()},[T,M,R]);function I(){let v=k.current?.getModel();c||v?.original?.dispose(),f||v?.modified?.dispose(),k.current?.dispose()}return B.createElement(je,{width:d,height:l,isEditorReady:M,loading:p,_ref:_,className:h,wrapperProps:w})}var Tt=Lt;a.memo(Tt);function _t(){let[e,t]=a.useState(Z.__getMonacoInstance());return ce(()=>{let r;return e||(r=Z.init(),r.then(n=>{t(n)})),()=>r?.cancel()}),e}var At=_t;function Pt(e){let t=a.useRef();return a.useEffect(()=>{t.current=e},[e]),t.current}var It=Pt,X=new Map;function Nt({defaultValue:e,defaultLanguage:t,defaultPath:r,value:n,language:o,path:i,theme:s="light",line:c,loading:f="Loading...",options:u={},overrideServices:p={},saveViewState:g=!0,keepCurrentModel:l=!1,width:d="100%",height:h="100%",className:w,wrapperProps:j={},beforeMount:E=K,onMount:M=K,onChange:y,onValidate:T=K}){let[O,k]=a.useState(!1),[C,_]=a.useState(!0),S=a.useRef(null),m=a.useRef(null),D=a.useRef(null),P=a.useRef(M),R=a.useRef(E),I=a.useRef(),v=a.useRef(n),b=It(i),le=a.useRef(!1),ee=a.useRef(!1);ce(()=>{let L=Z.init();return L.then(x=>(S.current=x)&&_(!1)).catch(x=>x?.type!=="cancelation"&&console.error("Monaco initialization: error:",x)),()=>m.current?Se():L.cancel()}),A(()=>{let L=z(S.current,e||n||"",t||o||"",i||r||"");L!==m.current?.getModel()&&(g&&X.set(b,m.current?.saveViewState()),m.current?.setModel(L),g&&m.current?.restoreViewState(X.get(i)))},[i],O),A(()=>{m.current?.updateOptions(u)},[u],O),A(()=>{!m.current||n===void 0||(m.current.getOption(S.current.editor.EditorOption.readOnly)?m.current.setValue(n):n!==m.current.getValue()&&(ee.current=!0,m.current.executeEdits("",[{range:m.current.getModel().getFullModelRange(),text:n,forceMoveMarkers:!0}]),m.current.pushUndoStop(),ee.current=!1))},[n],O),A(()=>{let L=m.current?.getModel();L&&o&&S.current?.editor.setModelLanguage(L,o)},[o],O),A(()=>{c!==void 0&&m.current?.revealLine(c)},[c],O),A(()=>{S.current?.editor.setTheme(s)},[s],O);let fe=a.useCallback(()=>{if(!(!D.current||!S.current)&&!le.current){R.current(S.current);let L=i||r,x=z(S.current,n||e||"",t||o||"",L||"");m.current=S.current?.editor.create(D.current,{model:x,automaticLayout:!0,...u},p),g&&m.current.restoreViewState(X.get(L)),S.current.editor.setTheme(s),c!==void 0&&m.current.revealLine(c),k(!0),le.current=!0}},[e,t,r,n,o,i,u,p,g,s,c]);a.useEffect(()=>{O&&P.current(m.current,S.current)},[O]),a.useEffect(()=>{!C&&!O&&fe()},[C,O,fe]),v.current=n,a.useEffect(()=>{O&&y&&(I.current?.dispose(),I.current=m.current?.onDidChangeModelContent(L=>{ee.current||y(m.current.getValue(),L)}))},[O,y]),a.useEffect(()=>{if(O){let L=S.current.editor.onDidChangeMarkers(x=>{let te=m.current.getModel()?.uri;if(te&&x.find(re=>re.path===te.path)){let re=S.current.editor.getModelMarkers({resource:te});T?.(re)}});return()=>{L?.dispose()}}return()=>{}},[O,T]);function Se(){I.current?.dispose(),l?g&&X.set(i,m.current.saveViewState()):m.current.getModel()?.dispose(),m.current.dispose()}return B.createElement(je,{width:d,height:h,isEditorReady:O,loading:f,_ref:D,className:w,wrapperProps:j})}var $t=Nt,Dt=a.memo($t),xt=Dt;const W="tasm",ae="func";let H=null,se=!1,be=!1;async function Ft(){if(H)return H;if(se)return null;se=!0;try{const e=await fetch("/assets/asm/asm.json");return e.ok?(H=await e.json(),H):(console.error("Failed to fetch asm.json:",e.statusText),null)}catch(e){return console.error("Error fetching or parsing asm.json:",e),null}finally{se=!1}}function ue(){if(H)return H;be||(be=!0,Ft())}function Rt(e){const t=ue();if(t===void 0)return;const r=Bt(e),n=t?.instructions.find(i=>i.mnemonic===r);if(n)return n;const o=t?.aliases.find(i=>i.mnemonic===e);if(o){const i=t?.instructions.find(s=>s.mnemonic===o.alias_of);if(i)return{...i,alias_info:o}}return null}function Bt(e){return e==="PUSHINT"?"PUSHINT_4":e==="XCHG0"?"XCHG_0I":e==="XCHG"?"XCHG_IJ":e}function ye(e){if(!e)return"";const t=e.trim(),r=t.startsWith("-")?"∅ ":"",n=t.endsWith("-")?" ∅":"";return`(${r+e.replace("-","→")+n})`}function Wt(e){return Object.entries(e).map(([t,r])=>r?.toString()??"").join(" ")}function zt(e){const t=e.doc.stack?`- Stack (top is on the right): \`${ye(e.doc.stack)}\``:"",r=e.doc.gas.length>0?e.doc.gas:"unknown",n=["```",e.mnemonic,"```",t,`- Gas: \`${r}\``,`- Opcode: \`${e.doc.opcode}\``,"",e.doc.description,"",""];if(e.alias_info){const i=` alias of ${Wt(e.alias_info.operands)+" "}${e.alias_info.alias_of}`,s=e.alias_info,c=s.doc_stack?`- Stack (top is on the right): \`${ye(s.doc_stack)}\``:"";return["```",s.mnemonic+i,"```",c,"",s.description??"","","---","","Aliased instruction info:","",...n].join(`
`)}return n.join(`
`)}const Ht={base:"vs",inherit:!0,rules:[{token:"keyword",foreground:"#0033B3",fontStyle:"bold"},{token:"string",foreground:"#067D17"},{token:"string.number",foreground:"#1750EB"},{token:"string.slice",foreground:"#1750EB"},{token:"string.asm",foreground:"#067D17",fontStyle:"italic"},{token:"number",foreground:"#1750EB"},{token:"number.hex",foreground:"#1750EB"},{token:"number.version",foreground:"#1750EB"},{token:"comment",foreground:"#8C8C8C",fontStyle:"italic"},{token:"keyword.directive",foreground:"#9C5D27"},{token:"identifier.function",foreground:"#795E26"},{token:"identifier.constant",foreground:"#871094",fontStyle:"bold"},{token:"identifier.special",foreground:"#795E26",fontStyle:"bold"},{token:"identifier.backtick",foreground:"#000000"},{token:"keyword.underscore",foreground:"#0033B3"},{token:"operator",foreground:"#000000"},{token:"instruction",foreground:"#0033B3"}],colors:{}},Ut={base:"vs-dark",inherit:!0,rules:[{token:"string",foreground:"#CE9178"},{token:"string.number",foreground:"#B5CEA8"},{token:"string.slice",foreground:"#B5CEA8"},{token:"string.asm",foreground:"#CE9178",fontStyle:"italic"},{token:"number",foreground:"#B5CEA8"},{token:"number.hex",foreground:"#B5CEA8"},{token:"number.version",foreground:"#B5CEA8"},{token:"comment",foreground:"#6A9955",fontStyle:"italic"},{token:"keyword.directive",foreground:"#C586C0"},{token:"identifier.function",foreground:"#DCDCAA"},{token:"identifier.constant",foreground:"#4FC1FF",fontStyle:"bold"},{token:"identifier.special",foreground:"#DCDCAA",fontStyle:"bold"},{token:"identifier.backtick",foreground:"#D4D4D4"},{token:"keyword.underscore",foreground:"#569CD6"},{token:"operator",foreground:"#D4D4D4"},{token:"instruction",foreground:"#749DED"},{token:"alias",foreground:"#9a9a9a"}],colors:{"editor.background":"#1c1c1e"}},Kt={defaultToken:"invalid",keywords:["forall","return","if","ifnot","else","elseif","elseifnot","repeat","do","until","while","global","const","asm","impure","inline","inline_ref","method_id","type","null","throw","throw_if","throw_unless","true","false","empty_tuple"],typeKeywords:["int","cell","slice","builder","cont","tuple","var"],directives:["#include","#pragma","version","not-version","allow-post-modification","compute-asm-ltr"],operators:["=","+=","-=","*=","/=","~/=","^/=","%=","~%=","^%=","<<=",">>=","~>>=","^>>=","&=","|=","^=","==","!=","<",">","<=",">=","<=>","<<",">>","~>>","^>>","+","-","|","^","*","/","%","~/","^/","~%","^%","/%","&","~",".","?",":","->","=>"],symbols:/[=><!~?:&|+\-*/^%]+/,tokenizer:{root:[[/;;.*$/,"comment"],[/\{-/,{token:"comment",next:"@comment"}],[/"""/,{token:"string.asm",next:"@asmblock"}],[/(#include|#pragma)\b/,"keyword.directive"],[/\b(version|not-version|allow-post-modification|compute-asm-ltr)\b/,"keyword.directive"],[/(>=|<=|=|>|<|\^)?([0-9]+)(.[0-9]+)?(.[0-9]+)?/,"number.version"],[/%[a-zA-Z_][a-zA-Z0-9_]*/,"identifier.function"],[/\$[a-zA-Z_][a-zA-Z0-9_$']*/,"identifier.special"],[/`[^`]+`/,"identifier.backtick"],[/\b[A-Z][A-Z0-9_]*\b/,"identifier.constant"],[/[a-zA-Z_][a-zA-Z0-9_'?]*(?=\()/,"identifier.function"],[/~[a-zA-Z_][a-zA-Z0-9_?]*/,"identifier.function"],[/\.[a-zA-Z_][a-zA-Z0-9_?]*/,"identifier.function"],[/[a-zA-Z_][a-zA-Z0-9_']*/,{cases:{"@keywords":"keyword","@typeKeywords":"type","@default":"identifier"}}],[/-?0x[0-9a-fA-F]+/,"number.hex"],[/-?\d+/,"number"],[/"[^"]*"[Hhcu]/,"string.number"],[/"[^"]*"[sa]/,"string.slice"],[/"[^"]*"/,"string"],[/~/,"operator"],[/@symbols/,{cases:{"@operators":"operator","@default":""}}],[/[{}]/,"@brackets"],[/[[\]]/,"delimiter.square"],[/[()]/,"delimiter.parenthesis"],[/;/,"delimiter"],[/,/,"delimiter"],[/_/,"keyword.underscore"],[/\s+/,"white"]],asmblock:[[/"""/,{token:"string.asm",next:"@pop"}],[/[^"]+/,"string.asm"],[/"/,"string.asm"]],comment:[[/[^-{]+/,"comment"],[/\{-/,{token:"comment",next:"@push"}],[/-\}/,{token:"comment",next:"@pop"}],[/[-{]/,"comment"]]}},qt={keywords:["ref","embed","exotic","library"],operators:["=>"],tokenizer:{root:[[/\b(ref|embed|exotic|library)\b/,"keyword"],[/\b[A-Z_][A-Z0-9_]*[0-9]?[0-9]?\b/,"instruction"],[/s-?[0-9][0-9]?/,"number.hex"],[/c[0-9][0-9]?/,"number.hex"],[/x\{[0-9a-fA-F_]*}/,"number.hex"],[/b\{[01]*}/,"number.binary"],[/boc\{[0-9a-fA-F]*}/,"number.hex"],[/"([^"\\]|\\.)*"/,"string"],[/-?\d+/,"number"],[/\{/,{token:"delimiter.curly",next:"@push"}],[/}/,{token:"delimiter.curly",next:"@pop"}],[/\[/,{token:"delimiter.square",next:"@push"}],[/]/,{token:"delimiter.square",next:"@pop"}],[/\(\)/,"delimiter.parenthesis"],[/\/\/.*?$/,"comment"],[/\b(alias|of)\b/,"alias"],[/\s+/,"white"]]}},Zt=(e,t)=>{t==="tasm"&&(e.languages.register({id:W}),e.languages.setMonarchTokensProvider(W,qt)),t==="func"&&(e.languages.register({id:ae}),e.languages.setMonarchTokensProvider(ae,Kt)),e.editor.defineTheme("light-theme",Ht),e.editor.defineTheme("dark-theme",Ut)},Vt=({language:e})=>{const t=At(),{theme:r}=Le(),[n,o]=a.useState(!1),[i,s]=a.useState(!1);return a.useEffect(()=>{typeof window<"u"&&typeof navigator<"u"&&s(navigator.platform.toUpperCase().indexOf("MAC")>=0)},[]),a.useEffect(()=>{if(t)try{Zt(t,e),o(!0)}catch(c){console.error("Failed to initialize Monaco:",c)}},[t,e]),a.useEffect(()=>{if(!(!t||!n))try{t.editor.setTheme(r==="dark"?"dark-theme":"light-theme")}catch(c){console.error("Failed to set theme:",c)}},[r,t,n]),a.useEffect(()=>{if(n&&e==="tasm")try{ue()}catch(c){console.warn("Failed to preload assembly data:",c)}},[n,e]),{monaco:t,isReady:n,isMac:i}},Gt=(e,t)=>({range:new e.Range(t,1,t,1),options:{isWholeLine:!0,className:"highlighted-line"}}),Xt=(e,t,r)=>{const n=[];for(const[o,i]of t.entries())for(const s of i.lines)s>0&&s<=r&&n.push({range:new e.Range(s,1,s,1),options:{isWholeLine:!0,className:i.className||`source-map-group-${o}`,overviewRuler:{color:i.color,position:1}}});return n},Jt=(e,t,r)=>{const n=[];for(const o of t)o>0&&o<=r&&n.push({range:new e.Range(o,1,o,1),options:{isWholeLine:!0,className:"source-map-hovered-line"}});return n},Yt=(e,t,r)=>{const n=[];for(const o of t)o.line>0&&o.line<=r&&n.push({range:new e.Range(o.line,o.startColumn,o.line,o.endColumn),options:{isWholeLine:!1,className:o.className??"precise-highlight",inlineClassName:o.className??"precise-highlight"}});return n},Qt=(e,t,r,n,o)=>{const i=[],s=o.getLineCount();for(let c=1;c<=s;c++){if(o.getLineContent(c).trim()==="")continue;const p=t[c]!==void 0;if(p&&r){const g=n===c?"clickable-line ctrl-pressed hovered-line":"clickable-line ctrl-pressed";i.push({range:new e.Range(c,1,c,1),options:{isWholeLine:!0,className:g,linesDecorationsClassName:"clickable-line-decoration"}})}else p||i.push({range:new e.Range(c,1,c,o.getLineLength(c)+1),options:{isWholeLine:!1,inlineClassName:"faded-text"}})}return i},er=({monaco:e,highlightLine:t,lineExecutionData:r,highlightGroups:n=[],hoveredLines:o=[],highlightRanges:i=[],isCtrlPressed:s=!1,hoveredLine:c=null,shouldCenter:f=!0})=>{const u=a.useRef([]),p=a.useCallback(l=>{if(!e||!l)return;const d=l.getModel();if(!d)return;const h=d.getLineCount(),w=[];try{t!==void 0&&w.push(Gt(e,t)),w.push(...Xt(e,n,h)),w.push(...Jt(e,o,h)),w.push(...Yt(e,i,h)),r&&Object.keys(r).length>0&&w.push(...Qt(e,r,s,c,d)),u.current=l.deltaDecorations(u.current,w),t!==void 0&&f&&l.revealLineInCenter(t)}catch(j){console.error("Failed to update decorations:",j)}},[e,t,n,o,i,r,f,s,c]),g=a.useCallback(l=>{if(l)try{u.current=l.deltaDecorations(u.current,[])}catch(d){console.error("Failed to clear decorations:",d)}},[]);return{updateDecorations:p,clearDecorations:g}},tr=({monaco:e,editorRef:t,lineExecutionData:r,onLineClick:n,onLineHover:o,editorReady:i=!0})=>{const[s,c]=a.useState(!1),[f,u]=a.useState(null),p=a.useCallback(d=>{(d.ctrlKey||d.metaKey)&&!s&&c(!0),(d.ctrlKey||d.metaKey)&&d.key==="s"&&(d.preventDefault(),d.stopPropagation())},[s]),g=a.useCallback(d=>{!d.ctrlKey&&!d.metaKey&&s&&(c(!1),u(null))},[s]),l=a.useCallback(()=>{s&&(c(!1),u(null))},[s]);return a.useEffect(()=>{if(!t.current||!e||!i)return;const d=t.current.onMouseDown(h=>{if(h.target.type!==e.editor.MouseTargetType.GUTTER_LINE_NUMBERS&&h.event.leftButton&&(h.event.ctrlKey||h.event.metaKey)){const w=h.target.position?.lineNumber;w&&r&&r[w]!==void 0&&n&&n(w)}});return()=>d.dispose()},[t,r,n,e,i]),a.useEffect(()=>{if(!e||!t.current||!i)return;const d=t.current.onMouseMove(j=>{const E=j.target.position?.lineNumber;s&&E&&r&&r[E]!==void 0?u(E):s&&u(null),o&&E&&o(E)}),h=()=>{s&&u(null),o&&o(null)},w=t.current.getDomNode();return w&&w.addEventListener("mouseleave",h),()=>{d.dispose(),w?.removeEventListener("mouseleave",h)}},[e,t,s,r,o,i]),a.useEffect(()=>(document.addEventListener("keydown",p),document.addEventListener("keyup",g),window.addEventListener("blur",l),()=>{document.removeEventListener("keydown",p),document.removeEventListener("keyup",g),window.removeEventListener("blur",l)}),[p,g,l]),{isCtrlPressed:s,hoveredLine:f}},rr=e=>{switch(e){case $.trace.FuncType.INT:return"int";case $.trace.FuncType.CELL:return"cell";case $.trace.FuncType.SLICE:return"slice";case $.trace.FuncType.BUILDER:return"builder";case $.trace.FuncType.CONT:return"cont";case $.trace.FuncType.TUPLE:return"tuple";case $.trace.FuncType.TYPE:return"type";default:return`type(${e})`}},nr=e=>{const t=[];return e&$.trace.FuncVarFlag.IN?"Parameter":e&$.trace.FuncVarFlag.NAMED?"Local variable":e&$.trace.FuncVarFlag.TMP?"Temp variable":t.length>0?t.join(", "):"var"},or=e=>e.length===0?"No variables in scope":`**Live variables:**

${[...e].reverse().map(r=>{const n=`${nr(r.flags)}`,o=`${r.name}`,i=rr(r.type),s=r.value??"",c=s.length!==0?` = ${s}`:"";return`${n} \`${o}: ${i}\`${c}
`}).join(`
`)}`,ir=({monaco:e,editorRef:t,lineExecutionData:r,getVariablesForLine:n,showVariablesDocs:o=!0,showInstructionDocs:i=!0,enabled:s})=>{a.useEffect(()=>{if(!e||!t.current||!s)return;const c=e.languages.registerHoverProvider(W,{provideHover(f,u){const p=f.getWordAtPosition(u),g=u.lineNumber,l=[];if(o&&n){const d=n(g);d&&d.length>0&&(l.push({value:or(d)}),l.push({value:"---"}))}if(p){const d=f.getLineContent(g),h=e.editor.tokenize(d,W)[0];let w="";for(let j=0;j<h.length;j++){const E=h[j],M=E.offset+1,y=j+1<h.length?h[j+1].offset+1:d.length+1;if(u.column>=M&&u.column<y){w=E.type;break}}if(w.includes("instruction")&&i){const j=Rt(p.word);if(j===void 0)l.push({value:"The assembly instructions documentation is loading—please hover over the instruction again."});else if(j){const E=zt(j);E&&l.push({value:E})}if(r){const E=r[g];l.length>0&&l.push({value:"---"}),E===void 0?l.push({value:"**Not executed**"}):l.push({value:`**Executions:** ${E.executions}`})}}}return l.length>0?{range:p?new e.Range(u.lineNumber,p.startColumn,u.lineNumber,p.endColumn):new e.Range(u.lineNumber,1,u.lineNumber,f.getLineLength(u.lineNumber)+1),contents:l}:null}});return()=>{c.dispose()}},[e,r,n,i,o,t,s])},sr=({monaco:e,editorRef:t,exitCode:r,editorReady:n,enabled:o})=>{a.useEffect(()=>{if(!e||!t.current||!n||!o)return;const i=e.languages.registerCodeLensProvider(W,{provideCodeLenses:s=>{if(!r?.info?.loc?.line&&r?.info?.loc?.line!==0)return{lenses:[],dispose:()=>{}};const c=r.info.loc.line+1;if(c<=0||c>s.getLineCount())return{lenses:[],dispose:()=>{}};const f=r.description?`: ${r.description}`:"";return{lenses:[{range:new e.Range(c,1,c,1),id:`exitCode-${c}`,command:{id:"noop",title:`⚡ Exit Code: ${r.num}${f}`,tooltip:`Transaction failed with exit code ${r.num}${f}`}}],dispose:()=>{}}},resolveCodeLens:(s,c)=>c});return()=>{i.dispose()}},[e,r,t,n,o])},ar=({monaco:e,editorRef:t,editorReady:r,enabled:n=!0})=>{a.useEffect(()=>{if(!e||!t.current||!r||!n)return;const o=e.languages.registerCompletionItemProvider(W,{triggerCharacters:[],provideCompletionItems(i,s){const c=ue();if(!c)return{suggestions:[]};const f=i.getWordUntilPosition(s),u={startLineNumber:s.lineNumber,endLineNumber:s.lineNumber,startColumn:f.startColumn,endColumn:f.endColumn},p=f.word.toUpperCase(),g=[];for(const l of c.instructions)p&&!l.mnemonic.startsWith(p)||g.push({label:l.mnemonic,kind:e.languages.CompletionItemKind.Function,insertText:l.mnemonic+" ",range:u,sortText:`0_${l.mnemonic}`,filterText:l.mnemonic});for(const l of c.aliases)p&&!l.mnemonic.startsWith(p)||g.push({label:l.mnemonic,kind:e.languages.CompletionItemKind.Function,insertText:l.mnemonic,range:u,sortText:`1_${l.mnemonic}`,filterText:l.mnemonic});return{suggestions:g}}});return()=>{o.dispose()}},[e,t,r,n])},cr=({monaco:e,editorRef:t,markers:r=[],enabled:n})=>{a.useEffect(()=>{if(!e||!t.current||!n)return;const o=t.current.getModel();if(o)return e.editor.setModelMarkers(o,"FunC",[...r]),()=>{e.editor.setModelMarkers(o,"FunC",[])}},[e,r,t,n])},ur=({monaco:e,editorRef:t,lineExecutionData:r})=>({collapseInactiveBlocks:a.useCallback(()=>{if(!t.current||!e)return;try{t.current.trigger("unfold","editor.unfoldAll",{})}catch{}const o=t.current.getModel();if(!o||!r||Object.keys(r).length===0)return;const i=o.getLineCount(),s=[],c=[],f=[];for(let u=1;u<=i;u++){const p=o.getLineContent(u),g=(p.match(/\{/g)??[]).length,l=(p.match(/}/g)??[]).length;for(let d=0;d<g;d++)f.push(u);for(let d=0;d<l;d++)if(f.length>0){const h=f.pop()??0;c.push({start:h,end:u,lines:[]})}}for(const u of c){let p=!0;for(let g=u.start;g<=u.end;g++){const l=o.getLineContent(g),d=r[g]!==void 0,h=l.trim()==="";if(d&&!h){p=!1;break}}p&&u.start<u.end&&s.push({start:u.start,end:u.end})}setTimeout(()=>{for(const u of s)try{t.current?.trigger("fold","editor.fold",{selectionLines:[u.start]})}catch{}},100)},[t,e,r])}),lr="_editorWrapperWithBorderRadius_8gtqf_99 _editorWrapper_8gtqf_93",fr="_editorWrapperWithoutBorderRadius_8gtqf_104 _editorWrapper_8gtqf_93",dr="_editorHint_8gtqf_109",pr="_hintDivider_8gtqf_149",J={editorWrapperWithBorderRadius:lr,editorWrapperWithoutBorderRadius:fr,editorHint:dr,hintDivider:pr};Z.config({monaco:Te});const Oe=({code:e,highlightLine:t,lineExecutionData:r,onLineClick:n=()=>{},onLineHover:o,shouldCenter:i=!0,exitCode:s,readOnly:c=!0,onChange:f,language:u="tasm",highlightGroups:p=[],hoveredLines:g=[],highlightRanges:l=[],markers:d=[],needBorderRadius:h=!0,getVariablesForLine:w,showVariablesDocs:j=!0,showInstructionDocs:E=!0,onEditorMount:M})=>{const y=a.useRef(null),[T,O]=a.useState(!1),[k,C]=a.useState(!1),{monaco:_,isMac:S}=Vt({language:u}),{isCtrlPressed:m,hoveredLine:D}=tr({monaco:_,editorRef:y,lineExecutionData:r,onLineClick:n,onLineHover:o,editorReady:T}),{updateDecorations:P}=er({monaco:_,highlightLine:t,lineExecutionData:r,highlightGroups:p,hoveredLines:g,highlightRanges:l,isCtrlPressed:m,hoveredLine:D,shouldCenter:i});ir({monaco:_,editorRef:y,lineExecutionData:r,getVariablesForLine:w,showVariablesDocs:j,showInstructionDocs:E,enabled:u==="tasm"}),sr({monaco:_,editorRef:y,exitCode:s,editorReady:T,enabled:u==="tasm"}),ar({monaco:_,editorRef:y,editorReady:T,enabled:u==="tasm"}),cr({monaco:_,editorRef:y,markers:d,enabled:u==="func"});const{collapseInactiveBlocks:R}=ur({monaco:_,editorRef:y,lineExecutionData:r}),I=a.useCallback(()=>{k||(C(!0),R())},[R,k]);a.useEffect(()=>{y.current&&(k||(P(y.current),I()))},[r,P,I,k]),a.useEffect(()=>{!T||!y.current||(P(y.current),I())},[T,P,I]),a.useEffect(()=>{y.current&&P(y.current)},[m,P]),a.useEffect(()=>{if(!T||!y.current)return;const b=()=>{y.current?.layout()};return window.addEventListener("resize",b),b(),()=>{window.removeEventListener("resize",b)}},[T]);const v=r&&u==="tasm";return N.jsxs(N.Fragment,{children:[N.jsx("div",{className:h?J.editorWrapperWithBorderRadius:J.editorWrapperWithoutBorderRadius,children:N.jsx(xt,{height:"100%",width:"100%",language:u==="func"?ae:W,path:u==="func"?"main.fc":"out.tasm",value:e,options:{minimap:{enabled:!1},readOnly:c,lineNumbers:"on",automaticLayout:!0,scrollBeyondLastLine:!1,wordWrap:"on",fontSize:14,fontFamily:"JetBrains Mono",glyphMargin:!0,folding:!0,foldingStrategy:"auto",stickyScroll:{enabled:!1},scrollbar:{useShadows:!1}},onMount:b=>{y.current=b,O(!0),M&&M(b)},onChange:b=>{f!==void 0&&b!==void 0&&f(b),y.current&&P(y.current)}})}),v&&N.jsxs("div",{className:J.editorHint,children:[N.jsx("kbd",{children:S?"⌘":"Ctrl"})," + ",N.jsx("kbd",{children:"Click"})," to navigate to trace step",N.jsx("span",{className:J.hintDivider,children:"|"}),N.jsx("kbd",{children:"←"})," ",N.jsx("kbd",{children:"→"})," to step through trace"]})]})};Oe.displayName="CodeEditor";const br=B.memo(Oe);export{br as default};
